program fpute_test;
#include( "stdlib.hhf" )

static
	f		:file;
	e32		:real32 := 0.0;
	e64		:real64 := 0.0;
	e80		:real80 := 0.0;
	
	e32a	:real32 := 1.0;
	e64a	:real64 := 1.0;
	e80a	:real80 := 1.0;
	
	e32b	:real32 := 1.0e-37;
	e64b	:real64 := 1.0e-307;
	e80b	:real80 := 1.0e-4094;
	
	e32pi	:real32;
	e64pi	:real64;
	e80pi	:real80;

	bad_a	:real64 := 1.0e-272;
	bad_b	:real64 := 1.0e-256;

	
begin fpute_test;

	f.create();
	f.openNew( "fc_pute.txt" );


	f.puts( "Outputting zeros:" nl nl );
	f.pute32( e32, 13 );
	f.newln();

	f.pute64( e64, 15 );
	f.newln();

	f.pute80( e80, 20 );
	f.newln();
	f.newln();
	f.newln();

	f.puts( "Real32 Powers of Ten: " nl nl );
	for( mov( -37, ecx ); (type int32 ecx) < 0; inc( ecx )) do

		f.pute32( e32b, 11 );
		f.newln();

		fld( e32b );
		fld( 10.0 );
		fmulp();
		fstp( e32b );

	endfor;
	fld1();
	fstp( e32b );
	for( mov( 0, ecx ); ecx < 38; inc( ecx )) do

		f.pute32( e32b, 11 );
		f.newln();

		fld( e32b );
		fld( 10.0 );
		fmulp();
		fstp( e32b );

	endfor;
	f.newln();
	f.newln();
	f.newln();


	f.puts( "Real64 Powers of Ten: " nl nl );
	for( mov( -307, ecx ); (type int32 ecx) < 0; inc( ecx )) do

		f.pute64( e64b, 15 );
		f.newln();

		fld( e64b );
		fld( 10.0 );
		fmulp();
		fstp( e64b );

	endfor;
	fld1();
	fstp( e64b );
	for( mov( 0, ecx ); ecx < 308; inc( ecx )) do

		f.pute64( e64b, 15 );
		f.newln();

		fld( e64b );
		fld( 10.0 );
		fmulp();
		fstp( e64b );

	endfor;
	f.newln();
	f.newln();
	f.newln();


	f.puts( "Real80 Powers of Ten: " nl nl );
	for( mov( -4094, ecx ); (type int32 ecx) < 0; inc( ecx )) do

		f.pute80( e80b, 20 );
		f.newln();

		fld( e80b );
		fld( 10.0 );
		fmulp();
		fstp( e80b );

	endfor;

	fld1();
	fstp( e80b );
	for( mov( 0, ecx ); ecx <= 4095; inc( ecx )) do

		f.pute80( e80b, 20 );
		f.newln();

		fld( e80b );
		fld( 10.0 );
		fmulp();
		fstp( e80b );

	endfor;
	f.newln();
	f.newln();
	f.newln();


	f.puts( "Real32 Powers of Two: " nl nl );
	for( mov( 0, ecx ); ecx < 127; inc( ecx )) do

		f.pute32( e32a, 11 );
		f.newln();

		fld( e32a );
		fld( 2.0 );
		fmulp();
		fstp( e32a );

	endfor;
	f.newln();
	f.newln();
	f.newln();

	f.puts( "Real64 Powers of Two: " nl nl );
	for( mov( 0, ecx ); ecx < 1023; inc( ecx )) do

		f.pute64( e64a, 15 );
		f.newln();

		fld( e64a );
		fld( 2.0 );
		fmulp();
		fstp( e64a );

	endfor;
	f.newln();
	f.newln();
	f.newln();



	f.puts( "Real80 Powers of Two: " nl nl );
	for( mov( 0, ecx ); ecx < 16383; inc( ecx )) do

		f.pute80( e80a, 18 );
		f.newln();

		fld( e80a );
		fld( 2.0 );
		fmulp();
		fstp( e80a );

	endfor;
	f.newln();
	f.newln();
	f.newln();




	fldpi();
	fstp( e32pi );
	fldpi();
	fstp( e64pi );
	fldpi();
	fstp( e80pi );

	f.puts( "Multiples of PI: " nl nl );
	for( mov( 0, ecx ); ecx < 32; inc( ecx )) do

		f.pute32( e32pi, 11 );
		f.newln();

		f.pute64( e64pi, 15 );
		f.newln();

		f.pute80( e80pi, 20 );
		f.newln();

		fld( e32pi );
		fldpi();
		fmulp();
		fstp( e32pi );

		fld( e64pi );
		fldpi();
		fmulp();
		fstp( e64pi );

		fld( e80pi );
		fldpi();
		fmulp();
		fstp( e80pi );

	endfor;
	f.newln();
	f.newln();
	f.newln();



	f.puts( "Divisions by PI: " nl nl );
	for( mov( 0, ecx ); ecx < 32; inc( ecx )) do

		f.pute32( e32pi, 11 );
		f.newln();

		f.pute64( e64pi, 15 );
		f.newln();

		f.pute80( e80pi, 20 );
		f.newln();

		fld( e32pi );
		fldpi();
		fdivp();
		fstp( e32pi );

		fld( e64pi );
		fldpi();
		fdivp();
		fstp( e64pi );

		fld( e80pi );
		fldpi();
		fdivp();
		fstp( e80pi );

	endfor;

	f.pute32( e32pi, 11 );
	f.newln();

	f.pute64( e64pi, 15 );
	f.newln();

	f.pute80( e80pi, 20 );
	f.newln();

	f.close();

end fpute_test;

													